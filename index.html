<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Focus Timer - Online Countdown</title>
    <meta name="description" content="A beautiful online timer with countdown, stopwatch, alarm clock and world clock. Multiple languages supported.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚è±Ô∏è</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #15151f;
            --bg-tertiary: #1e1e2e;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --accent: #00d4ff;
            --accent-secondary: #ff6b6b;
            --success: #51cf66;
            --warning: #ffd43b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Language Selector */
        .lang-selector {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }

        .lang-btn {
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lang-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent);
        }

        .lang-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 8px;
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            overflow: hidden;
            display: none;
            min-width: 150px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .lang-dropdown.show {
            display: block;
        }

        .lang-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lang-option:hover {
            background: var(--bg-tertiary);
        }

        .lang-flag {
            font-size: 1.2rem;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 20px;
            background: var(--bg-secondary);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            padding: 12px 24px;
            background: transparent;
            border: 2px solid transparent;
            color: var(--text-secondary);
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.05);
        }

        .nav-tab.active {
            color: var(--accent);
            border-color: var(--accent);
            background: rgba(0, 212, 255, 0.1);
        }

        /* Main Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Timer Display */
        .timer-display-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            position: relative;
        }

        .progress-ring-container {
            position: relative;
            width: 320px;
            height: 320px;
        }

        .progress-ring-container svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }

        .progress-ring-bg {
            fill: none;
            stroke: var(--bg-tertiary);
            stroke-width: 6;
        }

        .progress-ring-fill {
            fill: none;
            stroke: var(--accent);
            stroke-width: 6;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.1s linear;
            filter: drop-shadow(0 0 10px var(--accent));
        }

        .timer-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4.5rem;
            font-weight: 200;
            font-variant-numeric: tabular-nums;
            font-family: 'SF Mono', 'JetBrains Mono', monospace;
            letter-spacing: -2px;
        }

        .timer-display.running {
            color: var(--accent);
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
        }

        .timer-display.paused {
            color: var(--text-secondary);
        }

        .timer-display.finished {
            color: var(--success);
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
        }

        .milliseconds {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-left: 5px;
        }

        /* Input Section */
        .input-section {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .time-input-group {
            text-align: center;
        }

        .time-input {
            width: 100%;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: 16px;
            padding: 20px;
            font-size: 2.5rem;
            color: var(--text-primary);
            text-align: center;
            font-family: 'SF Mono', monospace;
            transition: all 0.3s ease;
        }

        .time-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .time-label {
            display: block;
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Quick Presets */
        .presets {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 25px 0;
        }

        .preset-btn {
            padding: 12px 20px;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: 25px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .preset-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            transform: translateY(-2px);
        }

        .preset-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .btn {
            padding: 16px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #0099ff);
            color: white;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid rgba(255,255,255,0.1);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            background: rgba(0, 212, 255, 0.1);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--accent-secondary), #ff4757);
            color: white;
        }

        /* Sound Settings */
        .settings-panel {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
        }

        .settings-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sound-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .sound-btn {
            padding: 12px;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .sound-btn:hover {
            border-color: var(--accent);
        }

        .sound-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        /* World Clock Section */
        .world-clock-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .clock-card {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .clock-card:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
        }

        .city-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .timezone-offset {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .clock-time {
            font-size: 2.5rem;
            font-family: 'SF Mono', monospace;
            font-weight: 300;
        }

        .clock-date {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 10px;
        }

        /* Stopwatch Laps */
        .laps-container {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 20px;
            margin-top: 30px;
            max-height: 300px;
            overflow-y: auto;
        }

        .lap-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .lap-item:last-child {
            border-bottom: none;
        }

        .lap-number {
            color: var(--accent);
            font-weight: 600;
        }

        .lap-time {
            font-family: 'SF Mono', monospace;
            font-size: 1.1rem;
        }

        /* Fullscreen Button */
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .fullscreen-btn:hover {
            background: var(--accent);
            color: var(--bg-primary);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .nav-tab {
                padding: 10px 16px;
                font-size: 0.85rem;
            }

            .progress-ring-container {
                width: 260px;
                height: 260px;
            }

            .timer-display {
                font-size: 3rem;
            }

            .input-grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="lang-selector">
        <button class="lang-btn" onclick="toggleLangDropdown()">
            <span id="current-lang-flag">üá∫üá∏</span>
            <span id="current-lang-name">English</span>
            <span>‚ñº</span>
        </button>
        <div class="lang-dropdown" id="langDropdown">
            <div class="lang-option" onclick="setLanguage('en')">
                <span class="lang-flag">üá∫üá∏</span>
                <span>English</span>
            </div>
            <div class="lang-option" onclick="setLanguage('zh')">
                <span class="lang-flag">üá®üá≥</span>
                <span>‰∏≠Êñá</span>
            </div>
            <div class="lang-option" onclick="setLanguage('es')">
                <span class="lang-flag">üá™üá∏</span>
                <span>Espa√±ol</span>
            </div>
            <div class="lang-option" onclick="setLanguage('ja')">
                <span class="lang-flag">üáØüáµ</span>
                <span>Êó•Êú¨Ë™û</span>
            </div>
            <div class="lang-option" onclick="setLanguage('ko')">
                <span class="lang-flag">üá∞üá∑</span>
                <span>ÌïúÍµ≠Ïñ¥</span>
            </div>
        </div>
    </div>

    <!-- Fullscreen Button -->
    <button class="fullscreen-btn" onclick="toggleFullscreen()" title="Fullscreen">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
        </svg>
    </button>

    <!-- Navigation -->
    <nav class="nav-tabs">
        <button class="nav-tab active" onclick="switchTab('timer')" data-tab="timer">
            ‚è±Ô∏è <span data-i18n="timer">Timer</span>
        </button>
        <button class="nav-tab" onclick="switchTab('stopwatch')" data-tab="stopwatch">
            ‚è≤Ô∏è <span data-i18n="stopwatch">Stopwatch</span>
        </button>
        <button class="nav-tab" onclick="switchTab('alarm')" data-tab="alarm">
            ‚è∞ <span data-i18n="alarm">Alarm</span>
        </button>
        <button class="nav-tab" onclick="switchTab('worldclock')" data-tab="worldclock">
            üåç <span data-i18n="worldClock">World Clock</span>
        </button>
    </nav>

    <div class="container">
        <!-- Timer Section -->
        <section id="timer-section" class="section active">
            <div class="timer-display-wrapper">
                <div class="progress-ring-container">
                    <svg>
                        <circle class="progress-ring-bg" cx="160" cy="160" r="150"/>
                        <circle class="progress-ring-fill" cx="160" cy="160" r="150" 
                                stroke-dasharray="942.48" stroke-dashoffset="0" id="timerProgress"/>
                    </svg>
                    <div class="timer-display" id="timerDisplay">25:00</div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-grid">
                    <div class="time-input-group">
                        <input type="number" class="time-input" id="hours" min="0" max="99" value="0" placeholder="00">
                        <span class="time-label" data-i18n="hours">Hours</span>
                    </div>
                    <div class="time-input-group">
                        <input type="number" class="time-input" id="minutes" min="0" max="59" value="25" placeholder="00">
                        <span class="time-label" data-i18n="minutes">Minutes</span>
                    </div>
                    <div class="time-input-group">
                        <input type="number" class="time-input" id="seconds" min="0" max="59" value="0" placeholder="00">
                        <span class="time-label" data-i18n="seconds">Seconds</span>
                    </div>
                </div>
            </div>

            <div class="presets">
                <button class="preset-btn active" onclick="setPreset(25, this)">üçÖ <span data-i18n="pomodoro">Pomodoro</span> (25<span data-i18n="min">min</span>)</button>
                <button class="preset-btn" onclick="setPreset(5, this)">‚òï <span data-i18n="shortBreak">Short Break</span> (5<span data-i18n="min">min</span>)</button>
                <button class="preset-btn" onclick="setPreset(15, this)">üßò <span data-i18n="longBreak">Long Break</span> (15<span data-i18n="min">min</span>)</button>
                <button class="preset-btn" onclick="setPreset(45, this)">üí™ <span data-i18n="focus">Deep Focus</span> (45<span data-i18n="min">min</span>)</button>
                <button class="preset-btn" onclick="setPreset(60, this)">üìö <span data-i18n="study">Study</span> (60<span data-i18n="min">min</span>)</button>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="startBtn" onclick="startTimer()">
                    ‚ñ∂Ô∏è <span data-i18n="start">Start</span>
                </button>
                <button class="btn btn-secondary" id="pauseBtn" onclick="pauseTimer()" style="display:none">
                    ‚è∏Ô∏è <span data-i18n="pause">Pause</span>
                </button>
                <button class="btn btn-danger" onclick="resetTimer()">
                    üîÑ <span data-i18n="reset">Reset</span>
                </button>
            </div>

            <div class="settings-panel">
                <div class="settings-title">üîî <span data-i18n="soundSettings">Sound Settings</span></div>
                <div class="sound-options">
                    <button class="sound-btn active" onclick="setSound('digital')" data-i18n="digital">Digital</button>
                    <button class="sound-btn" onclick="setSound('bell')" data-i18n="bell">Bell</button>
                    <button class="sound-btn" onclick="setSound('chime')" data-i18n="chime">Chime</button>
                    <button class="sound-btn" onclick="setSound('nature')" data-i18n="nature">Nature</button>
                </div>
                <div class="controls" style="margin:0">
                    <button class="btn btn-secondary" onclick="testSound()">
                        üîä <span data-i18n="testSound">Test Sound</span>
                    </button>
                    <button class="btn btn-secondary" onclick="toggleNotification()">
                        üîî <span data-i18n="browserNotify">Browser Notifications</span>: <span id="notifyStatus">OFF</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Stopwatch Section -->
        <section id="stopwatch-section" class="section">
            <div class="timer-display-wrapper">
                <div class="timer-display" id="stopwatchDisplay" style="position:static;font-size:6rem">00:00<span class="milliseconds">.00</span></div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="swStartBtn" onclick="startStopwatch()">
                    ‚ñ∂Ô∏è <span data-i18n="start">Start</span>
                </button>
                <button class="btn btn-secondary" id="swPauseBtn" onclick="pauseStopwatch()" style="display:none">
                    ‚è∏Ô∏è <span data-i18n="pause">Pause</span>
                </button>
                <button class="btn btn-secondary" onclick="lapStopwatch()">
                    ‚è±Ô∏è <span data-i18n="lap">Lap</span>
                </button>
                <button class="btn btn-danger" onclick="resetStopwatch()">
                    üîÑ <span data-i18n="reset">Reset</span>
                </button>
            </div>

            <div class="laps-container" id="lapsContainer" style="display:none">
                <div class="settings-title">üìä <span data-i18n="laps">Laps</span></div>
                <div id="lapsList"></div>
            </div>
        </section>

        <!-- Alarm Section -->
        <section id="alarm-section" class="section">
            <div class="input-section">
                <div class="input-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="time-input-group">
                        <input type="number" class="time-input" id="alarmHour" min="0" max="23" value="08" placeholder="00">
                        <span class="time-label" data-i18n="hour">Hour</span>
                    </div>
                    <div class="time-input-group">
                        <input type="number" class="time-input" id="alarmMinute" min="0" max="59" value="00" placeholder="00">
                        <span class="time-label" data-i18n="minute">Minute</span>
                    </div>
                </div>
            </div>

            <div class="presets">
                <button class="preset-btn" onclick="setAlarmPreset(6,0)">üåÖ 06:00</button>
                <button class="preset-btn" onclick="setAlarmPreset(7,0)">‚òÄÔ∏è 07:00</button>
                <button class="preset-btn" onclick="setAlarmPreset(8,0)">üíº 08:00</button>
                <button class="preset-btn" onclick="setAlarmPreset(9,0)">üïò 09:00</button>
                <button class="preset-btn" onclick="setAlarmPreset(22,0)">üåô 22:00</button>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="setAlarm()">
                    ‚è∞ <span data-i18n="setAlarm">Set Alarm</span>
                </button>
                <button class="btn btn-danger" onclick="cancelAlarm()">
                    ‚ùå <span data-i18n="cancel">Cancel</span>
                </button>
            </div>

            <div class="settings-panel" id="activeAlarms" style="display:none">
                <div class="settings-title">üîî <span data-i18n="activeAlarms">Active Alarms</span></div>
                <div id="alarmsList"></div>
            </div>
        </section>

        <!-- World Clock Section -->
        <section id="worldclock-section" class="section">
            <div class="world-clock-grid" id="worldClockGrid">
                <!-- Generated by JS -->
            </div>
        </section>
    </div>

    <div class="footer">
        <p>‚è±Ô∏è <span data-i18n="footer">Focus Timer - Make every minute count</span></p>
        <p style="margin-top:10px;font-size:0.8rem">Made with ‚ù§Ô∏è | <a href="https://github.com/kanshaowz/focus-timer" target="_blank">GitHub</a></p>
    </div>

    <script>
        // ==================== I18N ====================
        const i18n = {
            en: {
                title: "Focus Timer - Online Countdown",
                timer: "Timer",
                stopwatch: "Stopwatch",
                alarm: "Alarm",
                worldClock: "World Clock",
                hours: "Hours",
                minutes: "Minutes",
                seconds: "Seconds",
                hour: "Hour",
                minute: "Minute",
                pomodoro: "Pomodoro",
                shortBreak: "Short Break",
                longBreak: "Long Break",
                focus: "Deep Focus",
                study: "Study",
                min: "min",
                start: "Start",
                pause: "Pause",
                reset: "Reset",
                lap: "Lap",
                setAlarm: "Set Alarm",
                cancel: "Cancel",
                soundSettings: "Sound Settings",
                digital: "Digital",
                bell: "Bell",
                chime: "Chime",
                nature: "Nature",
                testSound: "Test Sound",
                browserNotify: "Browser Notifications",
                laps: "Laps",
                activeAlarms: "Active Alarms",
                footer: "Focus Timer - Make every minute count",
                timeUp: "Time's Up!",
                takeBreak: "Take a break!"
            },
            zh: {
                title: "‰∏ìÊ≥®ËÆ°Êó∂Âô® - Âú®Á∫øÂÄíËÆ°Êó∂",
                timer: "ËÆ°Êó∂Âô®",
                stopwatch: "ÁßíË°®",
                alarm: "ÈóπÈíü",
                worldClock: "‰∏ñÁïåÊó∂Èíü",
                hours: "Êó∂",
                minutes: "ÂàÜ",
                seconds: "Áßí",
                hour: "Êó∂",
                minute: "ÂàÜ",
                pomodoro: "Áï™ËåÑÈíü",
                shortBreak: "Áü≠‰ºëÊÅØ",
                longBreak: "Èïø‰ºëÊÅØ",
                focus: "Ê∑±Â∫¶‰∏ìÊ≥®",
                study: "Â≠¶‰π†",
                min: "ÂàÜÈíü",
                start: "ÂºÄÂßã",
                pause: "ÊöÇÂÅú",
                reset: "ÈáçÁΩÆ",
                lap: "ËÆ°Âúà",
                setAlarm: "ËÆæÁΩÆÈóπÈíü",
                cancel: "ÂèñÊ∂à",
                soundSettings: "Â£∞Èü≥ËÆæÁΩÆ",
                digital: "ÁîµÂ≠êÈü≥",
                bell: "ÈìÉÂ£∞",
                chime: "È£éÈìÉ",
                nature: "Ëá™ÁÑ∂",
                testSound: "ÊµãËØïÂ£∞Èü≥",
                browserNotify: "ÊµèËßàÂô®ÈÄöÁü•",
                laps: "ËÆ°Âúà",
                activeAlarms: "Â∑≤ËÆæÈóπÈíü",
                footer: "‰∏ìÊ≥®ËÆ°Êó∂Âô® - ËÆ©ÊØè‰∏ÄÂàÜÈíüÈÉΩÊúâ‰ª∑ÂÄº",
                timeUp: "Êó∂Èó¥Âà∞ÔºÅ",
                takeBreak: "‰ºëÊÅØ‰∏Ä‰∏ãÂêßÔºÅ"
            },
            es: {
                title: "Temporizador de Enfoque - Cuenta Regresiva",
                timer: "Temporizador",
                stopwatch: "Cron√≥metro",
                alarm: "Alarma",
                worldClock: "Reloj Mundial",
                hours: "Horas",
                minutes: "Minutos",
                seconds: "Segundos",
                hour: "Hora",
                minute: "Minuto",
                pomodoro: "Pomodoro",
                shortBreak: "Descanso Corto",
                longBreak: "Descanso Largo",
                focus: "Enfoque Profundo",
                study: "Estudio",
                min: "min",
                start: "Iniciar",
                pause: "Pausar",
                reset: "Reiniciar",
                lap: "Vuelta",
                setAlarm: "Configurar Alarma",
                cancel: "Cancelar",
                soundSettings: "Configuraci√≥n de Sonido",
                digital: "Digital",
                bell: "Campana",
                chime: "Carrill√≥n",
                nature: "Naturaleza",
                testSound: "Probar Sonido",
                browserNotify: "Notificaciones del Navegador",
                laps: "Vueltas",
                activeAlarms: "Alarmas Activas",
                footer: "Temporizador de Enfoque - Haz que cada minuto cuente",
                timeUp: "¬°Se acab√≥ el tiempo!",
                takeBreak: "¬°Toma un descanso!"
            },
            ja: {
                title: "„Éï„Ç©„Éº„Ç´„Çπ„Çø„Ç§„Éû„Éº - „Ç™„É≥„É©„Ç§„É≥„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥",
                timer: "„Çø„Ç§„Éû„Éº",
                stopwatch: "„Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ",
                alarm: "„Ç¢„É©„Éº„É†",
                worldClock: "‰∏ñÁïåÊôÇË®à",
                hours: "ÊôÇÈñì",
                minutes: "ÂàÜ",
                seconds: "Áßí",
                hour: "ÊôÇ",
                minute: "ÂàÜ",
                pomodoro: "„Éù„É¢„Éâ„Éº„É≠",
                shortBreak: "Áü≠„ÅÑ‰ºëÊÜ©",
                longBreak: "Èï∑„ÅÑ‰ºëÊÜ©",
                focus: "„Éá„Ç£„Éº„Éó„Éï„Ç©„Éº„Ç´„Çπ",
                study: "ÂãâÂº∑",
                min: "ÂàÜ",
                start: "ÈñãÂßã",
                pause: "‰∏ÄÊôÇÂÅúÊ≠¢",
                reset: "„É™„Çª„ÉÉ„Éà",
                lap: "„É©„ÉÉ„Éó",
                setAlarm: "„Ç¢„É©„Éº„É†Ë®≠ÂÆö",
                cancel: "„Ç≠„É£„É≥„Çª„É´",
                soundSettings: "„Çµ„Ç¶„É≥„ÉâË®≠ÂÆö",
                digital: "„Éá„Ç∏„Çø„É´",
                bell: "„Éô„É´",
                chime: "„ÉÅ„É£„Ç§„É†",
                nature: "Ëá™ÁÑ∂",
                testSound: "„ÉÜ„Çπ„ÉàÈü≥",
                browserNotify: "„Éñ„É©„Ç¶„Ç∂ÈÄöÁü•",
                laps: "„É©„ÉÉ„Éó",
                activeAlarms: "„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™„Ç¢„É©„Éº„É†",
                footer: "„Éï„Ç©„Éº„Ç´„Çπ„Çø„Ç§„Éû„Éº - ‰∏ÄÂàÜ‰∏ÄÁßí„ÇíÂ§ßÂàá„Å´",
                timeUp: "ÊôÇÈñì„Åß„ÅôÔºÅ",
                takeBreak: "‰ºëÊÜ©„Åó„Åæ„Åó„Çá„ÅÜÔºÅ"
            },
            ko: {
                title: "ÏßëÏ§ë ÌÉÄÏù¥Î®∏ - Ïò®ÎùºÏù∏ Ïπ¥Ïö¥Ìä∏Îã§Ïö¥",
                timer: "ÌÉÄÏù¥Î®∏",
                stopwatch: "Ïä§ÌÜ±ÏõåÏπò",
                alarm: "ÏïåÎûå",
                worldClock: "ÏÑ∏Í≥Ñ ÏãúÍ≥Ñ",
                hours: "ÏãúÍ∞Ñ",
                minutes: "Î∂Ñ",
                seconds: "Ï¥à",
                hour: "Ïãú",
                minute: "Î∂Ñ",
                pomodoro: "ÎΩÄÎ™®ÎèÑÎ°ú",
                shortBreak: "ÏßßÏùÄ Ìú¥Ïãù",
                longBreak: "Í∏¥ Ìú¥Ïãù",
                focus: "Îî• Ìè¨Ïª§Ïä§",
                study: "Í≥µÎ∂Ä",
                min: "Î∂Ñ",
                start: "ÏãúÏûë",
                pause: "ÏùºÏãúÏ†ïÏßÄ",
                reset: "Î¶¨ÏÖã",
                lap: "Îû©",
                setAlarm: "ÏïåÎûå ÏÑ§Ï†ï",
                cancel: "Ï∑®ÏÜå",
                soundSettings: "ÏÜåÎ¶¨ ÏÑ§Ï†ï",
                digital: "ÎîîÏßÄÌÑ∏",
                bell: "Î≤®",
                chime: "Ï∞®ÏûÑ",
                nature: "ÏûêÏó∞",
                testSound: "ÌÖåÏä§Ìä∏ ÏÇ¨Ïö¥Îìú",
                browserNotify: "Î∏åÎùºÏö∞Ï†Ä ÏïåÎ¶º",
                laps: "Îû©",
                activeAlarms: "ÌôúÏÑ± ÏïåÎûå",
                footer: "ÏßëÏ§ë ÌÉÄÏù¥Î®∏ - Îß§ Î∂ÑÏùÑ ÏÜåÏ§ëÌïòÍ≤å",
                timeUp: "ÏãúÍ∞ÑÏûÖÎãàÎã§!",
                takeBreak: "Ìú¥ÏãùÏùÑ Ï∑®ÌïòÏÑ∏Ïöî!"
            }
        };

        let currentLang = localStorage.getItem('lang') || 'en';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            updateUI();
            document.getElementById('langDropdown').classList.remove('show');
            
            // Update current lang display
            const flags = {en: 'üá∫üá∏', zh: 'üá®üá≥', es: 'üá™üá∏', ja: 'üáØüáµ', ko: 'üá∞üá∑'};
            const names = {en: 'English', zh: '‰∏≠Êñá', es: 'Espa√±ol', ja: 'Êó•Êú¨Ë™û', ko: 'ÌïúÍµ≠Ïñ¥'};
            document.getElementById('current-lang-flag').textContent = flags[lang];
            document.getElementById('current-lang-name').textContent = names[lang];
            
            // Update HTML lang attribute
            document.documentElement.lang = lang;
            
            // Update title
            document.getElementById('page-title').textContent = i18n[lang].title;
        }

        function updateUI() {
            const t = i18n[currentLang];
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });
        }

        function toggleLangDropdown() {
            document.getElementById('langDropdown').classList.toggle('show');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.lang-selector')) {
                document.getElementById('langDropdown').classList.remove('show');
            }
        });

        // ==================== TIMER ====================
        let totalSeconds = 25 * 60;
        let remainingSeconds = 25 * 60;
        let timerInterval = null;
        let isTimerRunning = false;
        let currentSound = 'digital';

        function updateTimerDisplay() {
            const h = Math.floor(remainingSeconds / 3600);
            const m = Math.floor((remainingSeconds % 3600) / 60);
            const s = remainingSeconds % 60;
            
            let display;
            if (h > 0) {
                display = `${h}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            } else {
                display = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            }
            
            document.getElementById('timerDisplay').textContent = display;
            document.title = `(${display}) ${i18n[currentLang].title}`;
            
            // Update progress ring
            const circle = document.getElementById('timerProgress');
            const circumference = 2 * Math.PI * 150;
            const progress = remainingSeconds / totalSeconds;
            const offset = circumference * (1 - progress);
            circle.style.strokeDashoffset = offset;
        }

        function setPreset(minutes, btn) {
            pauseTimer();
            document.getElementById('hours').value = 0;
            document.getElementById('minutes').value = minutes;
            document.getElementById('seconds').value = 0;
            applyCustomTime();
            
            document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function applyCustomTime() {
            const h = parseInt(document.getElementById('hours').value) || 0;
            const m = parseInt(document.getElementById('minutes').value) || 0;
            const s = parseInt(document.getElementById('seconds').value) || 0;
            
            totalSeconds = h * 3600 + m * 60 + s;
            if (totalSeconds === 0) totalSeconds = 60;
            
            remainingSeconds = totalSeconds;
            updateTimerDisplay();
        }

        function startTimer() {
            if (isTimerRunning) return;
            
            applyCustomTime();
            isTimerRunning = true;
            
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('timerDisplay').classList.add('running');
            document.getElementById('timerDisplay').classList.remove('paused');
            
            timerInterval = setInterval(() => {
                if (remainingSeconds > 0) {
                    remainingSeconds--;
                    updateTimerDisplay();
                } else {
                    finishTimer();
                }
            }, 1000);
        }

        function pauseTimer() {
            if (!isTimerRunning) return;
            
            isTimerRunning = false;
            clearInterval(timerInterval);
            
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('timerDisplay').classList.remove('running');
            document.getElementById('timerDisplay').classList.add('paused');
        }

        function resetTimer() {
            pauseTimer();
            applyCustomTime();
            document.getElementById('timerDisplay').classList.remove('paused', 'finished');
        }

        function finishTimer() {
            pauseTimer();
            playAlarm();
            document.getElementById('timerDisplay').classList.add('finished');
            
            if (notificationsEnabled) {
                showNotification(i18n[currentLang].timeUp, i18n[currentLang].takeBreak);
            }
        }

        // ==================== STOPWATCH ====================
        let swStartTime = 0;
        let swElapsed = 0;
        let swInterval = null;
        let isSwRunning = false;
        let laps = [];

        function updateStopwatchDisplay() {
            const totalMs = swElapsed;
            const m = Math.floor(totalMs / 60000);
            const s = Math.floor((totalMs % 60000) / 1000);
            const ms = Math.floor((totalMs % 1000) / 10);
            
            const display = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}<span class="milliseconds">.${ms.toString().padStart(2, '0')}</span>`;
            document.getElementById('stopwatchDisplay').innerHTML = display;
        }

        function startStopwatch() {
            if (isSwRunning) return;
            
            isSwRunning = true;
            swStartTime = Date.now() - swElapsed;
            
            document.getElementById('swStartBtn').style.display = 'none';
            document.getElementById('swPauseBtn').style.display = 'inline-block';
            
            swInterval = setInterval(() => {
                swElapsed = Date.now() - swStartTime;
                updateStopwatchDisplay();
            }, 10);
        }

        function pauseStopwatch() {
            if (!isSwRunning) return;
            
            isSwRunning = false;
            clearInterval(swInterval);
            
            document.getElementById('swStartBtn').style.display = 'inline-block';
            document.getElementById('swPauseBtn').style.display = 'none';
        }

        function resetStopwatch() {
            pauseStopwatch();
            swElapsed = 0;
            laps = [];
            updateStopwatchDisplay();
            document.getElementById('lapsContainer').style.display = 'none';
            document.getElementById('lapsList').innerHTML = '';
        }

        function lapStopwatch() {
            if (!isSwRunning) return;
            
            laps.push(swElapsed);
            document.getElementById('lapsContainer').style.display = 'block';
            
            const lapDiv = document.createElement('div');
            lapDiv.className = 'lap-item';
            
            const m = Math.floor(swElapsed / 60000);
            const s = Math.floor((swElapsed % 60000) / 1000);
            const ms = Math.floor((swElapsed % 1000) / 10);
            const timeStr = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}.${ms.toString().padStart(2, '0')}`;
            
            lapDiv.innerHTML = `
                <span class="lap-number">#${laps.length}</span>
                <span class="lap-time">${timeStr}</span>
            `;
            
            document.getElementById('lapsList').prepend(lapDiv);
        }

        // ==================== ALARM ====================
        let alarms = [];
        let alarmCheckInterval = null;

        function setAlarmPreset(h, m) {
            document.getElementById('alarmHour').value = h.toString().padStart(2, '0');
            document.getElementById('alarmMinute').value = m.toString().padStart(2, '0');
        }

        function setAlarm() {
            const h = parseInt(document.getElementById('alarmHour').value) || 0;
            const m = parseInt(document.getElementById('alarmMinute').value) || 0;
            
            const now = new Date();
            let alarmTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0);
            
            if (alarmTime <= now) {
                alarmTime.setDate(alarmTime.getDate() + 1);
            }
            
            const alarm = {
                id: Date.now(),
                hour: h,
                minute: m,
                time: alarmTime
            };
            
            alarms.push(alarm);
            updateAlarmsList();
            
            if (!alarmCheckInterval) {
                alarmCheckInterval = setInterval(checkAlarms, 1000);
            }
        }

        function cancelAlarm() {
            alarms = [];
            updateAlarmsList();
            clearInterval(alarmCheckInterval);
            alarmCheckInterval = null;
        }

        function updateAlarmsList() {
            const container = document.getElementById('activeAlarms');
            const list = document.getElementById('alarmsList');
            
            if (alarms.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            container.style.display = 'block';
            list.innerHTML = alarms.map(a => `
                <div class="lap-item">
                    <span>‚è∞ ${a.hour.toString().padStart(2, '0')}:${a.minute.toString().padStart(2, '0')}</span>
                    <span style="color: var(--text-secondary);">${a.time.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                </div>
            `).join('');
        }

        function checkAlarms() {
            const now = new Date();
            alarms.forEach(alarm => {
                if (now >= alarm.time && now - alarm.time < 1000) {
                    playAlarm();
                    if (notificationsEnabled) {
                        showNotification('‚è∞ Alarm!', 'Time to wake up!');
                    }
                }
            });
        }

        // ==================== WORLD CLOCK ====================
        const cities = [
            { name: 'Beijing', nameZh: 'Âåó‰∫¨', timezone: 'Asia/Shanghai', nameEs: 'Pek√≠n', nameJa: 'Âåó‰∫¨', nameKo: 'Î≤†Ïù¥Ïßï' },
            { name: 'New York', nameZh: 'Á∫ΩÁ∫¶', timezone: 'America/New_York', nameEs: 'Nueva York', nameJa: '„Éã„É•„Éº„É®„Éº„ÇØ', nameKo: 'Îâ¥Ïöï' },
            { name: 'London', nameZh: '‰º¶Êï¶', timezone: 'Europe/London', nameEs: 'Londres', nameJa: '„É≠„É≥„Éâ„É≥', nameKo: 'Îü∞Îçò' },
            { name: 'Tokyo', nameZh: '‰∏ú‰∫¨', timezone: 'Asia/Tokyo', nameEs: 'Tokio', nameJa: 'Êù±‰∫¨', nameKo: 'ÎèÑÏøÑ' },
            { name: 'Sydney', nameZh: 'ÊÇâÂ∞º', timezone: 'Australia/Sydney', nameEs: 'S√≠dney', nameJa: '„Ç∑„Éâ„Éã„Éº', nameKo: 'ÏãúÎìúÎãà' },
            { name: 'Paris', nameZh: 'Â∑¥Èªé', timezone: 'Europe/Paris', nameEs: 'Par√≠s', nameJa: '„Éë„É™', nameKo: 'ÌååÎ¶¨' },
            { name: 'Dubai', nameZh: 'Ëø™Êãú', timezone: 'Asia/Dubai', nameEs: 'Dub√°i', nameJa: '„Éâ„Éê„Ç§', nameKo: 'ÎëêÎ∞îÏù¥' },
            { name: 'Singapore', nameZh: 'Êñ∞Âä†Âù°', timezone: 'Asia/Singapore', nameEs: 'Singapur', nameJa: '„Ç∑„É≥„Ç¨„Éù„Éº„É´', nameKo: 'Ïã±Í∞ÄÌè¨Î•¥' }
        ];

        function updateWorldClocks() {
            const grid = document.getElementById('worldClockGrid');
            const now = new Date();
            
            grid.innerHTML = cities.map(city => {
                const time = new Date(now.toLocaleString('en-US', { timeZone: city.timezone }));
                const timeStr = time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const dateStr = time.toLocaleDateString(currentLang === 'en' ? 'en-US' : currentLang, { 
                    month: 'short', 
                    day: 'numeric',
                    weekday: 'short'
                });
                
                const offset = Math.round((time - now) / 3600000);
                const offsetStr = offset === 0 ? 'Same time' : offset > 0 ? `+${offset}h` : `${offset}h`;
                
                const cityNames = {
                    en: city.name,
                    zh: city.nameZh,
                    es: city.nameEs,
                    ja: city.nameJa,
                    ko: city.nameKo
                };
                
                return `
                    <div class="clock-card">
                        <div class="city-name">${cityNames[currentLang] || city.name}</div>
                        <div class="timezone-offset">${offsetStr}</div>
                        <div class="clock-time">${timeStr}</div>
                        <div class="clock-date">${dateStr}</div>
                    </div>
                `;
            }).join('');
        }

        setInterval(updateWorldClocks, 1000);

        // ==================== SOUND & NOTIFICATIONS ====================
        let notificationsEnabled = false;

        function setSound(type) {
            currentSound = type;
            document.querySelectorAll('.sound-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function playAlarm() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            const frequencies = {
                digital: [800, 1000, 1200],
                bell: [523, 659, 784],
                chime: [1047, 1319, 1568],
                nature: [440, 554, 659]
            };
            
            const freqs = frequencies[currentSound] || frequencies.digital;
            
            freqs.forEach((freq, i) => {
                setTimeout(() => {
                    const osc = audioContext.createOscillator();
                    const gain = audioContext.createGain();
                    
                    osc.connect(gain);
                    gain.connect(audioContext.destination);
                    
                    osc.frequency.value = freq;
                    osc.type = currentSound === 'nature' ? 'sine' : 'square';
                    
                    gain.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    osc.start(audioContext.currentTime);
                    osc.stop(audioContext.currentTime + 0.5);
                }, i * 200);
            });
        }

        function testSound() {
            playAlarm();
        }

        function toggleNotification() {
            if (!notificationsEnabled) {
                if ('Notification' in window) {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            notificationsEnabled = true;
                            document.getElementById('notifyStatus').textContent = 'ON';
                        }
                    });
                }
            } else {
                notificationsEnabled = false;
                document.getElementById('notifyStatus').textContent = 'OFF';
            }
        }

        function showNotification(title, body) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, { body, icon: '‚è±Ô∏è' });
            }
        }

        // ==================== TAB SWITCHING ====================
        function switchTab(tab) {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            document.getElementById(`${tab}-section`).classList.add('active');
            
            if (tab === 'worldclock') {
                updateWorldClocks();
            }
        }

        // ==================== FULLSCREEN ====================
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // ==================== KEYBOARD SHORTCUTS ====================
        document.addEventListener('keydown', (e) => {
            const activeSection = document.querySelector('.section.active').id;
            
            if (activeSection === 'timer-section') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    isTimerRunning ? pauseTimer() : startTimer();
                } else if (e.code === 'KeyR') {
                    resetTimer();
                }
            } else if (activeSection === 'stopwatch-section') {
                if (e.code === 'Space') {
                    e.preventDefault();
                    isSwRunning ? pauseStopwatch() : startStopwatch();
                } else if (e.code === 'KeyL') {
                    lapStopwatch();
                } else if (e.code === 'KeyR') {
                    resetStopwatch();
                }
            }
            
            if (e.code === 'KeyF') {
                toggleFullscreen();
            }
        });

        // ==================== INIT ====================
        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(currentLang);
            updateTimerDisplay();
            updateWorldClocks();
            
            // Check URL params
            const params = new URLSearchParams(window.location.search);
            const time = params.get('t');
            if (time) {
                const [m, s] = time.split(':').map(Number);
                if (m) {
                    document.getElementById('minutes').value = m;
                    document.getElementById('seconds').value = s || 0;
                    applyCustomTime();
                }
            }
        });
    </script>
</body>
</html>
